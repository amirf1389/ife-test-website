<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SkyStream In-Flight Entertainment</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap" />
    <style>
        /* Custom font import for a clean, modern look */
        @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap");

        body {
            font-family: "Inter", sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        /* --- Dark Mode Styles --- */
        .dark body {
            background-color: #0d121c;
            color: #e2e8f0;
        }

        .dark .bg-gray-950 {
            background-color: #0d121c;
        }

        .dark .bg-gray-900 {
            background-color: #111827;
        }

        .dark .bg-gray-800 {
            background-color: #1f2937;
        }

        .dark .bg-gray-700 {
            background-color: #374151;
        }

        .dark .border-gray-800 {
            border-color: #1f2937;
        }

        .dark .text-gray-50 {
            color: #f8fafc;
        }

        .dark .text-gray-400 {
            color: #9ca3af;
        }

        .dark .text-gray-300 {
            color: #d1d5db;
        }

        /* Dark mode scrollbar */
        .dark ::-webkit-scrollbar {
            width: 8px;
        }

        .dark ::-webkit-scrollbar-track {
            background: #0b172a;
        }

        .dark ::-webkit-scrollbar-thumb {
            background: #3b82f6;
            border-radius: 4px;
        }

        .dark ::-webkit-scrollbar-thumb:hover {
            background: #2563eb;
        }

        /* Dark mode map specific styles */
        .dark #map {
            background-color: #161b22;
        }

        .dark .leaflet-tile-container img {
            filter: invert(80%) hue-rotate(180deg) brightness(85%);
        }

        .dark .gradient-overlay {
            background: linear-gradient(to top,
                    rgba(17, 24, 39, 0.9) 0%,
                    rgba(17, 24, 39, 0.7) 30%,
                    transparent 100%);
        }

        /* --- Light Mode Styles --- */
        .light body {
            background-color: #f3f4f6;
            color: #111827;
        }

        .light .bg-gray-950 {
            background-color: #e5e7eb;
        }

        .light .bg-gray-900 {
            background-color: #ffffff;
        }

        .light .bg-gray-800 {
            background-color: #f9fafb;
        }

        .light .bg-gray-700 {
            background-color: #f3f4f6;
        }

        .light .border-gray-800 {
            border-color: #e5e7eb;
        }

        .light .text-gray-50 {
            color: #1f2937;
        }

        .light .text-gray-400 {
            color: #6b7280;
        }

        .light .text-gray-300 {
            color: #4b5563;
        }

        .light .text-gray-100 {
            color: #111827;
        }

        .light .text-white {
            color: #111827;
        }

        /* Light mode shadows */
        .light .shadow-lg {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
                0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .light .shadow-xl {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
                0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Light mode scrollbar */
        .light ::-webkit-scrollbar {
            width: 8px;
        }

        .light ::-webkit-scrollbar-track {
            background: #d1d5db;
        }

        .light ::-webkit-scrollbar-thumb {
            background: #2563eb;
            border-radius: 4px;
        }

        .light ::-webkit-scrollbar-thumb:hover {
            background: #1d4ed8;
        }

        /* Light mode map specific styles */
        .light .leaflet-container {
            background-color: #d1d5db;
        }

        .light .leaflet-tile-container img {
            filter: none;
        }

        .light .gradient-overlay {
            background: linear-gradient(to top,
                    rgba(255, 255, 255, 0.9) 0%,
                    rgba(255, 255, 255, 0.7) 30%,
                    transparent 100%);
        }

        /* --- General/Shared Styles --- */
        #map {
            height: 100%;
            width: 100%;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1),
                0 10px 15px rgba(0, 0, 0, 0.1);
        }

        .plane-icon {
            font-size: 24px;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
            transform-origin: center center;
        }

        /* Styling for the success message to be invisible by default */
        .copy-message {
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .copy-message.show {
            opacity: 1;
            transform: translateY(0);
        }

        .card-hover-effect:hover .card-overlay {
            opacity: 1;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: #3b82f6;
            cursor: pointer;
            border-radius: 50%;
        }

        .volume-slider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #3b82f6;
            cursor: pointer;
            border-radius: 50%;
        }

        /* CSS for the video player with description */
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
        }

        .video-container iframe,
        .video-container video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body class="bg-gray-950 text-white min-h-screen">
    <div id="app" class="flex flex-col min-h-screen">
        <header class="sticky top-0 z-50 bg-gray-900 border-b border-gray-800 shadow-lg">
            <div class="container mx-auto px-4 py-3 flex flex-col sm:flex-row justify-between items-center">
                <div class="flex items-center space-x-3 mb-3 sm:mb-0">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="lucide lucide-airplay text-blue-400">
                        <path d="M5 17H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-1"></path>
                        <path d="m12 15 5 6H7l5-6z"></path>
                    </svg>
                    <span class="text-2xl font-bold text-gray-50">SkyStream</span>
                </div>
                <nav class="flex flex-wrap justify-center sm:justify-start gap-2 sm:gap-4">
                    <button id="home-btn" data-view="home"
                        class="nav-btn flex items-center space-x-2 p-2 rounded-lg transition-colors duration-200 text-white bg-blue-600">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-home">
                            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                            <polyline points="9 22 9 12 15 12 15 22"></polyline>
                        </svg>
                        <span class="hidden md:inline">Home</span>
                    </button>
                    <button id="flight-map-btn" data-view="flight-map"
                        class="nav-btn flex items-center space-x-2 p-2 rounded-lg transition-colors duration-200 text-gray-400 hover:text-white hover:bg-gray-800">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-map">
                            <polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"></polygon>
                            <line x1="9" x2="9" y1="3" y2="18"></line>
                            <line x1="15" x2="15" y1="6" y2="21"></line>
                        </svg>
                        <span class="hidden md:inline">Flight Map</span>
                    </button>
                    <button id="wifi-btn" data-view="wifi"
                        class="nav-btn flex items-center space-x-2 p-2 rounded-lg transition-colors duration-200 text-gray-400 hover:text-white hover:bg-gray-800">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-wifi">
                            <path d="M5 12.55a7 7 0 0 1 14 0" />
                            <path d="M8.5 16.1a3.5 3.5 0 0 1 7 0" />
                            <line x1="12" x2="12.01" y1="20" y2="20" />
                        </svg>
                        <span class="hidden md:inline">WiFi</span>
                    </button>
                    <button id="movies-btn" data-view="movies"
                        class="nav-btn flex items-center space-x-2 p-2 rounded-lg transition-colors duration-200 text-gray-400 hover:text-white hover:bg-gray-800">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" view-box="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-film">
                            <rect width="18" height="18" x="3" y="3" rx="2"></rect>
                            <path d="M7 3v18"></path>
                            <path d="M3 7.5h4"></path>
                            <path d="M3 12h18"></path>
                            <path d="M3 16.5h4"></path>
                            <path d="M17 3v18"></path>
                            <path d="M17 7.5h4"></path>
                            <path d="M17 16.5h4"></path>
                        </svg>
                        <span class="hidden md:inline">Movies</span>
                    </button>
                    <button id="tv-btn" data-view="tv"
                        class="nav-btn flex items-center space-x-2 p-2 rounded-lg transition-colors duration-200 text-gray-400 hover:text-white hover:bg-gray-800">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-tv">
                            <rect width="20" height="15" x="2" y="7" rx="2" ry="2"></rect>
                            <polyline points="17 2 12 7 7 2"></polyline>
                        </svg>
                        <span class="hidden md:inline">TV Shows</span>
                    </button>
                    <button id="live-tv-btn" data-view="live-tv"
                        class="nav-btn flex items-center space-x-2 p-2 rounded-lg transition-colors duration-200 text-gray-400 hover:text-white hover:bg-gray-800">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-radio">
                            <path d="M4.9 19.1C1 15.2 1 8.8 4.9 4.9" />
                            <path d="M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5" />
                            <circle cx="12" cy="12" r="2" />
                        </svg>
                        <span class="hidden md:inline">Live TV</span>
                    </button>
                    <button id="news-btn" data-view="news"
                        class="nav-btn flex items-center space-x-2 p-2 rounded-lg transition-colors duration-200 text-gray-400 hover:text-white hover:bg-gray-800">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-newspaper">
                            <path d="M4 4h16v16H4z"></path>
                            <path d="M4 8h16"></path>
                            <path d="M4 12h16"></path>
                            <path d="M4 16h16"></path>
                        </svg>
                        <span class="hidden md:inline">News</span>
                    </button>
                    <button id="music-btn" data-view="music"
                        class="nav-btn flex items-center space-x-2 p-2 rounded-lg transition-colors duration-200 text-gray-400 hover:text-white hover:bg-gray-800">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-music">
                            <path d="M9 18V5l12-2v13"></path>
                            <circle cx="6" cy="18" r="3"></circle>
                            <circle cx="18" cy="16" r="3"></circle>
                        </svg>
                        <span class="hidden md:inline">Music</span>
                    </button>
                    <button id="products-btn" data-view="products"
                        class="nav-btn flex items-center space-x-2 p-2 rounded-lg transition-colors duration-200 text-gray-400 hover:text-white hover:bg-gray-800">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-shopping-bag">
                            <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"></path>
                            <path d="M3 6h18"></path>
                            <path d="M16 10a4 4 0 0 1-8 0"></path>
                        </svg>
                        <span class="hidden md:inline">Products</span>
                    </button>
                    <button id="settings-btn" data-view="settings"
                        class="nav-btn flex items-center space-x-2 p-2 rounded-lg transition-colors duration-200 text-gray-400 hover:text-white hover:bg-gray-800">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-settings">
                            <path
                                d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.39a2 2 0 0 0 .73 2.73l.15.08a2 2 0 0 1 1 1.73v.55a2 2 0 0 1-1 1.73l-.15.08a2 2 0 0 0-.73 2.73l.22.39a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.73v-.55a2 2 0 0 1 1-1.73l.15-.08a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                            </path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        <span class="hidden md:inline">Settings</span>
                    </button>
                </nav>
            </div>
        </header>

        <main id="app-main" class="flex-grow container mx-auto px-4 py-8 overflow-y-auto"></main>

        <div id="now-playing-bar"
            class="fixed bottom-0 left-0 right-0 hidden bg-gray-900 p-4 border-t border-gray-800 shadow-2xl z-50 transition-transform duration-300 transform translate-y-full">
            <div class="container mx-auto flex items-center justify-between">
                <div class="flex items-center space-x-4 flex-grow overflow-hidden">
                    <img id="player-album-art" src="https://placehold.co/64x64/1f2937/d1d5db?text=Album" alt="Album Art"
                        class="w-16 h-16 rounded-lg shadow-md flex-shrink-0" />
                    <div class="flex-grow overflow-hidden">
                        <h4 id="player-title" class="text-lg font-bold truncate">
                            Title
                        </h4>
                        <p id="player-artist" class="text-sm text-gray-400 truncate">
                            Artist
                        </p>
                    </div>
                </div>
                <div class="flex items-center space-x-4 pl-4 flex-shrink-0">
                    <button id="prev-btn" title="Previous"
                        class="text-gray-400 hover:text-white transition-colors duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-skip-back">
                            <polygon points="19 20 9 12 19 4 19 20" />
                            <line x1="5" x2="5" y1="19" y2="5" />
                        </svg>
                    </button>
                    <button id="play-pause-btn" title="Play/Pause"
                        class="bg-blue-600 text-white rounded-full p-3 shadow-lg transform transition-transform duration-200 hover:scale-110 active:scale-95">
                        <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28"
                            viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play">
                            <polygon points="5 3 19 12 5 21 5 3" />
                        </svg>
                        <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28"
                            viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pause hidden">
                            <rect width="6" height="16" x="4" y="4" />
                            <rect width="6" height="16" x="14" y="4" />
                        </svg>
                    </button>
                    <button id="next-btn" title="Next"
                        class="text-gray-400 hover:text-white transition-colors duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-skip-forward">
                            <polygon points="5 4 15 12 5 20 5 4" />
                            <line x1="19" x2="19" y1="5" y2="19" />
                        </svg>
                    </button>
                </div>
                <div class="flex items-center space-x-2 pl-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="lucide lucide-volume text-gray-400">
                        <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" />
                    </svg>
                    <label for="volume-slider" class="sr-only">Volume</label>
                    <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1"
                        class="w-24 h-2 rounded-lg appearance-none bg-gray-700 hover:bg-gray-600 transition-colors cursor-pointer volume-slider" />
                </div>
            </div>
        </div>

        <footer class="bg-gray-900 text-gray-400 p-4 text-center text-sm border-t border-gray-800">
            <p>&copy; 2025 SkyStream Airlines. All rights reserved.</p>
        </footer>
    </div>

    <div id="video-modal"
        class="fixed inset-0 bg-gray-950 bg-opacity-95 hidden items-center justify-center z-[100] p-4">
        <div class="relative w-full max-w-4xl mx-auto rounded-xl shadow-2xl overflow-hidden">
            <div class="video-container">
                <video id="media-player" controls class="w-full h-full object-cover rounded-xl"></video>
            </div>
            <div class="p-6 bg-gray-800 text-white rounded-b-xl">
                <h3 id="video-description-title" class="text-2xl font-bold mb-2"></h3>
                <p id="video-description-text" class="text-gray-300 mb-4"></p>
                <div class="flex justify-end space-x-4">
                    <button id="exit-player-btn"
                        class="bg-gray-600 text-white font-semibold py-2 px-6 rounded-full hover:bg-gray-700 transition-all duration-200">
                        Exit Player
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="description-modal"
        class="fixed inset-0 bg-gray-950 bg-opacity-95 hidden items-center justify-center z-[100] p-4">
        <div class="relative bg-gray-900 rounded-xl p-8 shadow-2xl max-w-2xl w-full mx-4 sm:mx-auto text-center">
            <div id="modal-content" class="text-left"></div>
            <button id="close-description-modal-btn"
                class="mt-6 w-full bg-blue-600 text-white font-semibold py-3 px-6 rounded-full hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200">
                Exit
            </button>
        </div>
    </div>

    <div id="purchase-modal"
        class="fixed inset-0 bg-gray-950 bg-opacity-95 hidden items-center justify-center z-[100] p-4">
        <div class="relative w-full max-w-sm mx-auto bg-gray-900 rounded-xl p-8 shadow-2xl text-center">
            <button title="Close Purchase Modal" id="close-purchase-modal-btn"
                class="absolute top-4 right-4 text-white text-opacity-70 hover:text-white transition-all duration-200 z-10">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-x-circle">
                    <circle cx="12" cy="12" r="10" />
                    <path d="m15 9-6 6" />
                    <path d="m9 9 6 6" />
                </svg>
            </button>
            <h3 class="text-xl font-bold mb-4">Purchase Confirmed!</h3>
            <p id="purchase-message" class="text-gray-400 mb-6">
                Thank you for your purchase.
            </p>
            <button id="ok-purchase-btn"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-full">
                OK
            </button>
        </div>
    </div>

    <div id="assistance-modal"
        class="fixed inset-0 bg-gray-950 bg-opacity-95 hidden items-center justify-center z-[100] p-4">
        <div class="relative w-full max-w-sm mx-auto bg-gray-900 rounded-xl p-8 shadow-2xl text-center">
            <h3 id="assistance-modal-title" class="text-xl font-bold mb-4"></h3>
            <p id="assistance-modal-message" class="text-gray-400 mb-6"></p>
            <button id="close-assistance-modal-btn"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-full">
                OK
            </button>
        </div>
    </div>

    <div id="welcome-popup"
        class="fixed inset-0 z-[200] hidden items-center justify-center bg-black bg-opacity-70 backdrop-blur-sm transition-opacity duration-300">
        <div
            class="bg-gray-900 p-8 rounded-xl shadow-2xl max-w-md w-11/12 mx-4 sm:mx-0 transform transition-transform duration-300 scale-100 border border-blue-600">
            <div class="text-center">
                <h2 class="text-3xl font-extrabold text-blue-400 mb-4">
                    ðŸŽ‰ Welcome to SkyStream! ðŸŽ‰
                </h2>
                <p class="text-gray-300 text-base leading-relaxed mb-6">
                    Your in-flight entertainment system provides a wide selection of
                    movies, TV shows, music, and more to make your journey enjoyable.
                </p>
                <button id="close-welcome-popup"
                    class="w-full bg-blue-600 text-white font-semibold py-3 px-6 rounded-full hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200">
                    Get Started
                </button>
            </div>
        </div>
    </div>

    <script>
        // Data for different content types
        const movies = [
            {
                id: 1,
                title: "The Cosmic Voyager",
                genre: "Sci-Fi",
                duration: "2h 15m",
                image:
                    "https://placehold.co/300x450/4f46e5/ffffff?text=Cosmic+Voyager",
                video:
                    "https://archive.org/download/cosmic-voyage-1936/cosmic-voyage-1936.mp4",
                description: "An epic sci-fi adventure following a lone astronaut on a journey to the far reaches of the cosmos to discover a new home for humanity."
            },
            {
                id: 2,
                title: "Lost in the Clouds",
                genre: "Adventure",
                duration: "1h 58m",
                image:
                    "https://placehold.co/300x450/10b981/ffffff?text=Lost+in+Clouds",
                video:
                    "https://drive.google.com/file/d/19s27q6B-M4MCkGViFHZ52VD9Esbl4HvU.mp4",
                description: "A thrilling tale of survival as a group of explorers becomes stranded in the perilous and beautiful world above the clouds."
            },
            {
                id: 3,
                title: "City of Shadows",
                genre: "Thriller",
                duration: "2h 05m",
                image:
                    "https://placehold.co/300x450/ef4444/ffffff?text=City+of+Shadows",
                video:
                    "https://ia800908.us.archive.org/6/items/mira-2022_202508/FULL%20MOVIE%2012%20HOURS%20until%20the%20end%20of%20the%20world%20pel%C3%ADcula%20completa%20%23fullmovie%20%23movie%20%23cinema%20%23movies.mp4",
                description: "A dark and gritty crime thriller about a detective who uncovers a web of corruption that threatens to consume the entire city."
            },
            {
                id: 4,
                title: "The Last Flight",
                genre: "Drama",
                duration: "1h 40m",
                image:
                    "https://placehold.co/300x450/f97316/ffffff?text=The+Last+Flight",
                video:
                    "https://dn720706.ca.archive.org/0/items/idiocracia-2006-brrip-m-720p-x-264-ac-3-es/Idiocracia%20%282006%29%20%5BBRrip%20m720p%20x264%20AC3%28ES%29%5D.mp4",
                description: "An emotional and poignant drama that follows the interconnected stories of several passengers on a life-altering journey."
            },
        ];

        // NEW: TV Shows Data with descriptions
        const tvShows = [
            {
                id: 1,
                title: "The Final Frontier",
                genre: "Sci-Fi",
                episodes: 10,
                duration: "45m",
                image:
                    "https://placehold.co/300x450/3b82f6/ffffff?text=Final+Frontier",
                video:
                    "https://www.learningcontainer.com/wp-content/uploads/2020/05/sample-mp4-file.mp4",
                description:
                    "A crew of explorers embarks on a dangerous mission to the edge of the known galaxy to find a new home for humanity.",
            },
            {
                id: 2,
                title: "Mystery on Aisle 7",
                genre: "Mystery",
                episodes: 6,
                duration: "50m",
                image:
                    "https://placehold.co/300x450/10b981/ffffff?text=Mystery+on+Aisle+7",
                video:
                    "https://www.learningcontainer.com/wp-content/uploads/2020/05/sample-mp4-file.mp4",
                description:
                    "In a quiet suburban town, a detective must unravel the secrets behind a series of bizarre disappearances at a local supermarket.",
            },
            {
                id: 3,
                title: "Beyond the Horizon",
                genre: "Documentary",
                episodes: 3,
                duration: "60m",
                image:
                    "https://placehold.co/300x450/ef4444/ffffff?text=Beyond+the+Horizon",
                video:
                    "https://www.learningcontainer.com/wp-content/uploads/2020/05/sample-mp4-file.mp4",
                description:
                    "An award-winning documentary series exploring the most remote and untouched landscapes on Earth, from the deep sea to the highest mountains.",
            },
            {
                id: 4,
                title: "The Royal Crown",
                genre: "Drama",
                episodes: 8,
                duration: "55m",
                image:
                    "https://placehold.co/300x450/f97316/ffffff?text=The+Royal+Crown",
                video:
                    "https://www.learningcontainer.com/wp-content/uploads/2020/05/sample-mp4-file.mp4",
                description:
                    "Follows the political rivalries and romance of Queen Elizabeth II's reign and the events that shaped the second half of the 20th century.",
            },
        ];

        const liveTvChannels = [
            {
                id: 1,
                name: "SkyStream News",
                logo: "https://placehold.co/150x75/3b82f6/ffffff?text=News+Channel",
                stream:
                    "http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4",
            },
            {
                id: 2,
                name: "World of Travel",
                logo: "https://placehold.co/150x75/10b981/ffffff?text=Travel+Channel",
                stream:
                    "http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4",
            },
            {
                id: 3,
                name: "Kids' Corner",
                logo: "https://placehold.co/150x75/f97316/ffffff?text=Kids+Channel",
                stream:
                    "http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",
            },
        ];

        const newsFeeds = [
            {
                id: 1,
                title: "Flight Arrives Ahead of Schedule, Citing Favorable Winds",
                source: "SkyStream News",
                date: "Aug 17, 2025",
                content: "Our flight, SK2025, from New York to London has arrived 30 minutes ahead of its scheduled time, thanks to a strong tailwind and efficient air traffic control. Passengers are now disembarking.",
                image: "https://placehold.co/600x400/3b82f6/ffffff?text=Flight+News"
            },
            {
                id: 2,
                title: "New Movie 'Stellar Drift' Now Available on SkyStream",
                source: "Entertainment Weekly",
                date: "Aug 17, 2025",
                content: "The highly anticipated sci-fi film 'Stellar Drift' has been added to the SkyStream movie library. Critics are calling it a visually stunning and emotionally powerful film. Tune in now!",
                image: "https://placehold.co/600x400/10b981/ffffff?text=Movie+News"
            },
            {
                id: 3,
                title: "SkyStream Launches New In-Flight WiFi Service",
                source: "Tech Journal",
                date: "Aug 16, 2025",
                content: "SkyStream Airlines has upgraded its fleet with a new high-speed satellite WiFi service, promising faster speeds and more reliable connectivity for all passengers. The new service is available immediately.",
                image: "https://placehold.co/600x400/f97316/ffffff?text=WiFi+News"
            },
        ];

        const musicAlbums = [
            {
                id: 1,
                title: "Above the Clouds",
                artist: "Aero Beats",
                genre: "Ambient",
                image: "https://placehold.co/300x300/1f2937/d1d5db?text=Album+1",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"
            },
            {
                id: 2,
                title: "Smooth Landing",
                artist: "Flight Lounge",
                genre: "Jazz",
                image: "https://placehold.co/300x300/1f2937/d1d5db?text=Album+2",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3"
            },
            {
                id: 3,
                title: "Global Rhythms",
                artist: "World Travelers",
                genre: "World",
                image: "https://placehold.co/300x300/1f2937/d1d5db?text=Album+3",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3"
            },
        ];

        const products = [
            {
                id: 1,
                name: "Noise-Cancelling Headphones",
                price: "â‚¬150",
                description: "Enjoy a peaceful flight with these premium headphones. Crisp audio and effective noise cancellation.",
                image: "https://placehold.co/300x300/3b82f6/ffffff?text=Headphones"
            },
            {
                id: 2,
                name: "Travel Pillow",
                price: "â‚¬25",
                description: "Ergonomically designed for maximum comfort on long-haul flights. Made from soft, memory foam.",
                image: "https://placehold.co/300x300/10b981/ffffff?text=Pillow"
            },
            {
                id: 3,
                name: "Blanket",
                price: "â‚¬35",
                description: "Stay warm and cozy with our SkyStream branded fleece blanket.",
                image: "https://placehold.co/300x300/f97316/ffffff?text=Blanket"
            },
        ];

        let currentMediaElement = null;
        let currentMediaType = null;
        let currentVolume = 1;
        let currentContentList = [];
        let currentContentIndex = -1;

        const appMain = document.getElementById("app-main");
        const navButtons = document.querySelectorAll(".nav-btn");
        const videoModal = document.getElementById("video-modal");
        const mediaPlayer = document.getElementById("media-player");
        const videoDescriptionTitle = document.getElementById("video-description-title");
        const videoDescriptionText = document.getElementById("video-description-text");
        const exitPlayerBtn = document.getElementById("exit-player-btn");
        const nowPlayingBar = document.getElementById("now-playing-bar");
        const playerAlbumArt = document.getElementById("player-album-art");
        const playerTitle = document.getElementById("player-title");
        const playerArtist = document.getElementById("player-artist");
        const playPauseBtn = document.getElementById("play-pause-btn");
        const playIcon = document.getElementById("play-icon");
        const pauseIcon = document.getElementById("pause-icon");
        const volumeSlider = document.getElementById("volume-slider");
        const prevBtn = document.getElementById("prev-btn");
        const nextBtn = document.getElementById("next-btn");
        const welcomePopup = document.getElementById("welcome-popup");
        const closeWelcomePopupBtn = document.getElementById("close-welcome-popup");
        const purchaseModal = document.getElementById("purchase-modal");
        const purchaseMessage = document.getElementById("purchase-message");
        const okPurchaseBtn = document.getElementById("ok-purchase-btn");
        const closePurchaseModalBtn = document.getElementById("close-purchase-modal-btn");
        const assistanceModal = document.getElementById("assistance-modal");
        const assistanceModalTitle = document.getElementById("assistance-modal-title");
        const assistanceModalMessage = document.getElementById("assistance-modal-message");
        const closeAssistanceModalBtn = document.getElementById("close-assistance-modal-btn");

        // Event Listeners
        navButtons.forEach((button) => {
            button.addEventListener("click", () => {
                const view = button.dataset.view;
                changeView(view);
                updateActiveNav(button);
            });
        });

        exitPlayerBtn.addEventListener("click", hideMediaPlayer);

        playPauseBtn.addEventListener("click", togglePlayback);
        volumeSlider.addEventListener("input", updateVolume);
        prevBtn.addEventListener("click", () => playNextPrev("prev"));
        nextBtn.addEventListener("click", () => playNextPrev("next"));
        closeWelcomePopupBtn.addEventListener("click", () => {
            welcomePopup.classList.add("hidden");
        });

        closePurchaseModalBtn.addEventListener("click", () => {
            purchaseModal.classList.add("hidden");
        });
        okPurchaseBtn.addEventListener("click", () => {
            purchaseModal.classList.add("hidden");
        });

        closeAssistanceModalBtn.addEventListener("click", () => {
            assistanceModal.classList.add("hidden");
        });

        // Functions
        function changeView(view) {
            appMain.innerHTML = "";
            switch (view) {
                case "home":
                    renderHome();
                    break;
                case "flight-map":
                    renderFlightMap();
                    break;
                case "wifi":
                    renderWiFi();
                    break;
                case "movies":
                    renderContent(movies, "movies");
                    break;
                case "tv":
                    renderContent(tvShows, "tv");
                    break;
                case "live-tv":
                    renderLiveTv();
                    break;
                case "news":
                    renderNews();
                    break;
                case "music":
                    renderMusic();
                    break;
                case "products":
                    renderProducts();
                    break;
                case "settings":
                    renderSettings();
                    break;
            }
        }

        function updateActiveNav(activeButton) {
            navButtons.forEach(btn => {
                btn.classList.remove("text-white", "bg-blue-600");
                btn.classList.add("text-gray-400", "hover:text-white", "hover:bg-gray-800");
            });
            activeButton.classList.remove("text-gray-400", "hover:text-white", "hover:bg-gray-800");
            activeButton.classList.add("text-white", "bg-blue-600");
        }

        function renderHome() {
            appMain.innerHTML = `
                <section class="mb-8">
                    <h2 class="text-3xl font-bold text-blue-400 mb-4">Featured Content</h2>
                    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
                        ${movies.slice(0, 4).map(item => `
                            <div class="relative overflow-hidden rounded-lg shadow-lg card-hover-effect cursor-pointer" data-id="${item.id}" data-type="movie">
                                <img src="${item.image}" alt="${item.title}" class="w-full h-auto object-cover rounded-lg" />
                                <div class="card-overlay absolute inset-0 bg-black bg-opacity-70 flex flex-col justify-end p-4 opacity-0 transition-opacity duration-300">
                                    <h3 class="text-xl font-bold text-white truncate">${item.title}</h3>
                                    <p class="text-gray-300 text-sm">${item.genre}</p>
                                    <button class="play-btn mt-2 bg-blue-600 text-white font-semibold py-2 px-4 rounded-full hover:bg-blue-700 transition-colors duration-200 focus:outline-none">
                                        Play
                                    </button>
                                </div>
                            </div>
                        `).join("")}
                    </div>
                </section>
                <section class="mb-8">
                    <h2 class="text-3xl font-bold text-blue-400 mb-4">Latest News</h2>
                    <div class="space-y-4">
                        ${newsFeeds.slice(0, 3).map(news => `
                            <div class="flex flex-col sm:flex-row bg-gray-900 rounded-lg p-4 shadow-lg">
                                <img src="${news.image}" alt="${news.title}" class="w-full sm:w-48 h-32 sm:h-auto object-cover rounded-md flex-shrink-0 mb-4 sm:mb-0 sm:mr-4" />
                                <div class="flex-grow">
                                    <h3 class="text-xl font-semibold text-gray-50 mb-1">${news.title}</h3>
                                    <p class="text-sm text-gray-400 mb-2">${news.source} | ${news.date}</p>
                                    <p class="text-gray-300 text-sm">${news.content}</p>
                                    <a href="#" class="text-blue-400 hover:underline text-sm mt-2 block read-more-btn" data-id="${news.id}" data-type="news">Read More</a>
                                </div>
                            </div>
                        `).join("")}
                    </div>
                </section>
                <section>
                    <h2 class="text-3xl font-bold text-blue-400 mb-4">Now Playing</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        <div class="bg-gray-900 rounded-lg shadow-xl p-6 relative">
                            <h3 class="text-xl font-semibold text-gray-50 mb-2">Flight Information</h3>
                            <div class="space-y-2">
                                <p class="text-gray-300">Flight: <span class="text-white font-semibold">SK2025</span></p>
                                <p class="text-gray-300">Route: <span class="text-white font-semibold">New York (JFK) to London (LHR)</span></p>
                                <p class="text-gray-300">Status: <span class="text-green-400 font-semibold">On Time</span></p>
                                <p class="text-gray-300">Est. Arrival: <span class="text-white font-semibold">05:30 AM</span></p>
                            </div>
                        </div>
                        <div class="bg-gray-900 rounded-lg shadow-xl p-6 relative">
                            <h3 class="text-xl font-semibold text-gray-50 mb-2">Connectivity</h3>
                            <div class="space-y-2">
                                <p class="text-gray-300">WiFi: <span class="text-green-400 font-semibold">Available</span></p>
                                <p class="text-gray-300">Portal: <span class="text-white font-semibold">skystream-wifi</span></p>
                                <p class="text-gray-300">Cost: <span class="text-white font-semibold">Starting from â‚¬9.99</span></p>
                                <button class="mt-4 bg-blue-600 text-white font-semibold py-2 px-6 rounded-full hover:bg-blue-700 transition-all duration-200">
                                    Connect Now
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            `;
            addContentEventListeners();
        }

        function renderContent(data, type) {
            currentContentList = data;
            appMain.innerHTML = `
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold text-blue-400">${type === "movies" ? "Movies" : "TV Shows"}</h2>
                    <div class="flex items-center space-x-2">
                        <span class="text-gray-400 text-sm">Filter by:</span>
                        <select id="genre-filter" class="bg-gray-800 text-gray-300 border border-gray-700 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="all">All Genres</option>
                            <option value="Sci-Fi">Sci-Fi</option>
                            <option value="Adventure">Adventure</option>
                            <option value="Thriller">Thriller</option>
                            <option value="Drama">Drama</option>
                            <option value="Mystery">Mystery</option>
                            <option value="Documentary">Documentary</option>
                        </select>
                    </div>
                </div>
                <div id="content-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6">
                    ${data.map(item => `
                        <div class="relative rounded-lg shadow-lg overflow-hidden transition-transform duration-300 transform hover:scale-105 cursor-pointer card-hover-effect" data-id="${item.id}" data-type="${type}">
                            <img src="${item.image}" alt="${item.title} poster" class="w-full h-auto object-cover rounded-lg" />
                            <div class="card-overlay absolute inset-0 bg-black bg-opacity-70 flex flex-col justify-end p-4 opacity-0 transition-opacity duration-300">
                                <h3 class="text-lg font-bold text-white truncate">${item.title}</h3>
                                <p class="text-gray-300 text-sm">${item.genre}</p>
                                <p class="text-gray-400 text-xs mt-1">${type === "movies" ? item.duration : `${item.episodes} Episodes`}</p>
                                <button class="play-btn mt-2 bg-blue-600 text-white font-semibold py-2 px-4 rounded-full hover:bg-blue-700 transition-colors duration-200 focus:outline-none">
                                    Play
                                </button>
                            </div>
                        </div>
                    `).join("")}
                </div>
            `;
            document.getElementById("genre-filter").addEventListener("change", (e) => filterContent(e.target.value, type));
            addContentEventListeners();
        }

        function addContentEventListeners() {
            document.querySelectorAll(".card-hover-effect").forEach(card => {
                card.addEventListener("click", (e) => {
                    const id = parseInt(e.currentTarget.dataset.id);
                    const type = e.currentTarget.dataset.type;
                    const item = currentContentList.find(c => c.id === id);
                    if (item) {
                        showMediaPlayer(item, type);
                    }
                });
            });
        }

        function showMediaPlayer(content, type) {
            if (currentMediaElement) {
                currentMediaElement.pause();
            }

            // Set the video source and play
            mediaPlayer.src = content.video;
            mediaPlayer.load(); // Load the new video source
            mediaPlayer.play().catch(error => {
                console.error("Autoplay failed:", error);
            });
            currentMediaElement = mediaPlayer;

            // Update the now playing bar
            updateNowPlayingBar(content, type);
            showNowPlayingBar();

            // Show the modal
            videoDescriptionTitle.textContent = content.title;
            videoDescriptionText.textContent = content.description;
            videoModal.classList.remove("hidden");
            videoModal.classList.add("flex");
        }

        function hideMediaPlayer() {
            if (currentMediaElement) {
                currentMediaElement.pause();
                currentMediaElement.src = ""; // Clear the source
            }
            videoModal.classList.remove("flex");
            videoModal.classList.add("hidden");
        }

        function updateNowPlayingBar(content, type) {
            playerAlbumArt.src = content.image;
            playerTitle.textContent = content.title;
            playerArtist.textContent = type === "music" ? content.artist : "Video Player";
            currentMediaType = type;
            currentContentIndex = currentContentList.findIndex(item => item.id === content.id);
        }

        function showNowPlayingBar() {
            nowPlayingBar.classList.remove("translate-y-full", "hidden");
            nowPlayingBar.classList.add("translate-y-0");
        }

        function togglePlayback() {
            if (currentMediaElement) {
                if (currentMediaElement.paused) {
                    currentMediaElement.play();
                    playIcon.classList.add("hidden");
                    pauseIcon.classList.remove("hidden");
                } else {
                    currentMediaElement.pause();
                    playIcon.classList.remove("hidden");
                    pauseIcon.classList.add("hidden");
                }
            }
        }

        function updateVolume() {
            if (currentMediaElement) {
                currentMediaElement.volume = volumeSlider.value;
                currentVolume = volumeSlider.value;
            }
        }

        function playNextPrev(direction) {
            if (currentContentList.length === 0 || currentContentIndex === -1) return;

            let newIndex = currentContentIndex;
            if (direction === "next") {
                newIndex = (currentContentIndex + 1) % currentContentList.length;
            } else if (direction === "prev") {
                newIndex = (currentContentIndex - 1 + currentContentList.length) % currentContentList.length;
            }

            const nextContent = currentContentList[newIndex];
            if (nextContent) {
                showMediaPlayer(nextContent, currentMediaType);
            }
        }

        function renderFlightMap() {
            appMain.innerHTML = `
                <h2 class="text-3xl font-bold text-blue-400 mb-6">Live Flight Map</h2>
                <div class="h-[600px] w-full rounded-xl relative shadow-xl">
                    <div id="map" class="rounded-xl z-0"></div>
                    <div class="absolute bottom-4 left-4 right-4 bg-gray-900 bg-opacity-80 backdrop-blur-md rounded-lg p-4 text-white gradient-overlay shadow-lg">
                        <h3 class="text-xl font-bold mb-2">Flight SK2025</h3>
                        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm font-medium">
                            <div>
                                <p class="text-gray-400">From</p>
                                <p class="text-lg text-gray-50">New York (JFK)</p>
                            </div>
                            <div>
                                <p class="text-gray-400">To</p>
                                <p class="text-lg text-gray-50">London (LHR)</p>
                            </div>
                            <div>
                                <p class="text-gray-400">Altitude</p>
                                <p class="text-lg text-gray-50">38,000 ft</p>
                            </div>
                            <div>
                                <p class="text-gray-400">Ground Speed</p>
                                <p class="text-lg text-gray-50">920 km/h</p>
                            </div>
                            <div>
                                <p class="text-gray-400">Time to Dest.</p>
                                <p class="text-lg text-gray-50">4h 15m</p>
                            </div>
                            <div>
                                <p class="text-gray-400">Distance to Dest.</p>
                                <p class="text-lg text-gray-50">3,900 km</p>
                            </div>
                            <div>
                                <p class="text-gray-400">Local Time</p>
                                <p class="text-lg text-gray-50" id="local-time"></p>
                            </div>
                            <div>
                                <p class="text-gray-400">Destination Time</p>
                                <p class="text-lg text-gray-50">05:30 AM</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            initMap();
        }

        function initMap() {
            const map = L.map('map', { zoomControl: false }).setView([45, -20], 3);

            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
                subdomains: 'abcd',
                maxZoom: 19
            }).addTo(map);

            const planeIcon = L.divIcon({
                html: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plane plane-icon text-blue-400 drop-shadow-lg"><path d="M17.8 19.2 16 11l3.5-3.5C21 6 22 5 22 4c0-1.2-0.7-2.1-2-2-1 0-2 0.5-3.5 2L11 6 2 4l3 2 2.5 1L2 12l5 2 2.5 1L2 18l3 2 1.5-1.5 5.5 5.5 2.5-2.5 2.5 2.5 2-3c1.5-1.5 2-2.5 2-3.5 0-1.2-1-2-2-2-1 0-2 0.5-3.5 2L17 13.5 15.2 15.2z"></path></svg>',
                className: 'custom-plane-icon',
                iconSize: [24, 24],
                iconAnchor: [12, 12],
            });

            const route = [
                [40.6413, -73.7781], // JFK
                [51.4700, -0.4543] // LHR
            ];
            L.polyline(route, { color: 'lightblue', weight: 4, dashArray: '5, 10' }).addTo(map);
            const planeMarker = L.marker([40.6413, -73.7781], { icon: planeIcon }).addTo(map);

            const updateMap = () => {
                const totalDuration = 24 * 60; // 24 hours in minutes
                const progress = (new Date().getMinutes() % totalDuration) / totalDuration;
                const lat = route[0][0] + (route[1][0] - route[0][0]) * progress;
                const lng = route[0][1] + (route[1][1] - route[0][1]) * progress;
                planeMarker.setLatLng([lat, lng]);

                // Update local time
                document.getElementById('local-time').textContent = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
            };

            setInterval(updateMap, 60000); // Update every minute
            updateMap(); // Initial call
        }

        function renderWiFi() {
            appMain.innerHTML = `
                <div class="text-center p-8 bg-gray-900 rounded-xl shadow-xl max-w-lg mx-auto">
                    <h2 class="text-3xl font-bold text-blue-400 mb-4">Connect to SkyStream WiFi</h2>
                    <p class="text-gray-300 mb-6">
                        Enjoy high-speed internet access throughout your flight. Choose a plan that's right for you.
                    </p>
                    <div id="qrcode" class="bg-white p-4 inline-block rounded-lg mb-6 shadow-md"></div>
                    <p class="text-gray-400 font-mono mb-2">skystream-wifi</p>
                    <div class="flex flex-col space-y-4">
                        <button class="bg-blue-600 text-white font-semibold py-3 px-6 rounded-full hover:bg-blue-700 transition-colors duration-200" data-plan="1-hour">
                            1 Hour Pass - â‚¬9.99
                        </button>
                        <button class="bg-blue-600 text-white font-semibold py-3 px-6 rounded-full hover:bg-blue-700 transition-colors duration-200" data-plan="full-flight">
                            Full Flight Pass - â‚¬19.99
                        </button>
                    </div>
                </div>
            `;
            new QRCode(document.getElementById("qrcode"), "skystream-wifi-login");
        }

        function renderLiveTv() {
            appMain.innerHTML = `
                <h2 class="text-3xl font-bold text-blue-400 mb-6">Live TV Channels</h2>
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    ${liveTvChannels.map(channel => `
                        <div class="relative rounded-lg shadow-lg overflow-hidden cursor-pointer card-hover-effect" data-id="${channel.id}" data-type="live-tv">
                            <img src="${channel.logo}" alt="${channel.name} logo" class="w-full h-auto object-cover rounded-lg" />
                            <div class="card-overlay absolute inset-0 bg-black bg-opacity-70 flex flex-col items-center justify-center p-4 opacity-0 transition-opacity duration-300">
                                <h3 class="text-xl font-bold text-white text-center">${channel.name}</h3>
                                <button class="play-btn mt-2 bg-blue-600 text-white font-semibold py-2 px-4 rounded-full hover:bg-blue-700 transition-colors duration-200 focus:outline-none">
                                    Watch
                                </button>
                            </div>
                        </div>
                    `).join("")}
                </div>
            `;
            addContentEventListeners();
        }

        function renderNews() {
            appMain.innerHTML = `
                <h2 class="text-3xl font-bold text-blue-400 mb-6">Latest News</h2>
                <div class="space-y-6">
                    ${newsFeeds.map(news => `
                        <div class="bg-gray-900 rounded-xl shadow-lg p-6 flex flex-col md:flex-row items-start space-y-4 md:space-y-0 md:space-x-6 transition-all duration-300 hover:shadow-xl">
                            <div class="flex-shrink-0 w-full md:w-48 h-32 overflow-hidden rounded-lg">
                                <img src="${news.image}" alt="${news.title}" class="w-full h-full object-cover transition-transform duration-300 hover:scale-110" />
                            </div>
                            <div class="flex-grow">
                                <span class="text-sm font-semibold text-gray-400">${news.source} â€¢ ${news.date}</span>
                                <h3 class="text-2xl font-bold text-gray-50 mt-1 mb-2">${news.title}</h3>
                                <p class="text-gray-300">${news.content}</p>
                                <button class="text-blue-400 hover:underline mt-4 text-sm font-semibold read-more-btn" data-id="${news.id}" data-type="news">
                                    Read Full Story &rarr;
                                </button>
                            </div>
                        </div>
                    `).join("")}
                </div>
            `;
            addNewsEventListeners();
        }

        function addNewsEventListeners() {
            document.querySelectorAll(".read-more-btn").forEach(btn => {
                btn.addEventListener("click", (e) => {
                    e.preventDefault();
                    const id = parseInt(e.currentTarget.dataset.id);
                    const newsItem = newsFeeds.find(n => n.id === id);
                    if (newsItem) {
                        showDescriptionModal(newsItem);
                    }
                });
            });
        }

        function showDescriptionModal(item) {
            const modal = document.getElementById("description-modal");
            const modalContent = document.getElementById("modal-content");
            modalContent.innerHTML = `
                <h3 class="text-2xl font-bold text-blue-400 mb-2">${item.title}</h3>
                <p class="text-gray-400 text-sm mb-4">
                    <span class="font-semibold">${item.source}</span> â€¢ ${item.date}
                </p>
                <img src="${item.image}" alt="${item.title}" class="w-full rounded-lg mb-4" />
                <p class="text-gray-300 leading-relaxed">${item.content}</p>
            `;
            modal.classList.remove("hidden");
            modal.classList.add("flex");
            document.getElementById("close-description-modal-btn").addEventListener("click", () => {
                modal.classList.remove("flex");
                modal.classList.add("hidden");
            });
        }

        function renderMusic() {
            appMain.innerHTML = `
                <h2 class="text-3xl font-bold text-blue-400 mb-6">Music Library</h2>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6">
                    ${musicAlbums.map(album => `
                        <div class="group relative rounded-lg shadow-lg overflow-hidden transition-transform duration-300 transform hover:scale-105 cursor-pointer play-music-btn" data-id="${album.id}">
                            <img src="${album.image}" alt="${album.title} album art" class="w-full h-auto object-cover rounded-lg" />
                            <div class="absolute inset-0 bg-black bg-opacity-70 flex flex-col justify-end p-4 opacity-0 transition-opacity duration-300 group-hover:opacity-100">
                                <h3 class="text-lg font-bold text-white truncate">${album.title}</h3>
                                <p class="text-gray-300 text-sm">${album.artist}</p>
                                <button class="play-btn mt-2 bg-blue-600 text-white font-semibold py-2 px-4 rounded-full hover:bg-blue-700 transition-colors duration-200 focus:outline-none">
                                    Play
                                </button>
                            </div>
                        </div>
                    `).join("")}
                </div>
            `;
            addMusicEventListeners();
        }

        function addMusicEventListeners() {
            document.querySelectorAll(".play-music-btn").forEach(button => {
                button.addEventListener("click", (e) => {
                    const id = parseInt(e.currentTarget.dataset.id);
                    const album = musicAlbums.find(a => a.id === id);
                    if (album) {
                        playMusic(album);
                    }
                });
            });
        }

        function playMusic(album) {
            if (currentMediaElement) {
                currentMediaElement.pause();
                currentMediaElement.remove();
            }

            const audioPlayer = new Audio(album.audio);
            audioPlayer.volume = currentVolume;
            audioPlayer.play().catch(error => {
                console.error("Autoplay failed:", error);
            });

            currentMediaElement = audioPlayer;
            currentMediaType = "music";
            currentContentList = musicAlbums;
            currentContentIndex = musicAlbums.findIndex(a => a.id === album.id);

            updateNowPlayingBar({ title: album.title, image: album.image, artist: album.artist }, "music");
            showNowPlayingBar();

            playIcon.classList.add("hidden");
            pauseIcon.classList.remove("hidden");
        }

        function renderProducts() {
            appMain.innerHTML = `
                <h2 class="text-3xl font-bold text-blue-400 mb-6">In-Flight Shopping</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
                    ${products.map(product => `
                        <div class="bg-gray-900 rounded-xl shadow-lg p-6 flex flex-col items-center text-center">
                            <img src="${product.image}" alt="${product.name}" class="w-full max-w-[200px] rounded-lg mb-4" />
                            <h3 class="text-xl font-bold text-gray-50 mb-2">${product.name}</h3>
                            <p class="text-gray-300 mb-4 flex-grow">${product.description}</p>
                            <span class="text-2xl font-extrabold text-blue-400 mb-4">${product.price}</span>
                            <button class="w-full bg-blue-600 text-white font-semibold py-3 px-6 rounded-full hover:bg-blue-700 transition-colors duration-200 purchase-btn" data-id="${product.id}">
                                Add to Cart
                            </button>
                        </div>
                    `).join("")}
                </div>
            `;
            document.querySelectorAll(".purchase-btn").forEach(btn => {
                btn.addEventListener("click", (e) => {
                    const id = parseInt(e.target.dataset.id);
                    const product = products.find(p => p.id === id);
                    if (product) {
                        showPurchaseModal(product);
                    }
                });
            });
        }

        function showPurchaseModal(product) {
            purchaseMessage.textContent = `Your order for "${product.name}" has been placed. A cabin crew member will be with you shortly.`;
            purchaseModal.classList.remove("hidden");
            purchaseModal.classList.add("flex");
        }

        function renderSettings() {
            appMain.innerHTML = `
                <div class="max-w-xl mx-auto bg-gray-900 rounded-xl shadow-xl p-8">
                    <h2 class="text-3xl font-bold text-blue-400 mb-6">Settings & Assistance</h2>
                    <div class="space-y-6">
                        <div class="flex items-center justify-between">
                            <span class="text-lg font-semibold text-gray-50">Dark Mode</span>
                            <label class="switch relative inline-block w-12 h-6">
                                <input type="checkbox" id="dark-mode-toggle" class="peer opacity-0 w-0 h-0" checked>
                                <span class="slider round absolute cursor-pointer top-0 left-0 right-0 bottom-0 bg-gray-700 rounded-full transition-colors duration-300 before:absolute before:h-5 before:w-5 before:rounded-full before:bg-white before:left-0.5 before:bottom-0.5 before:transition-transform before:duration-300 peer-checked:bg-blue-600 peer-checked:before:translate-x-6"></span>
                            </label>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-50 mb-2">Language</h3>
                            <select id="language-select" class="w-full bg-gray-800 text-gray-300 border border-gray-700 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="en">English</option>
                                <option value="fr">French</option>
                                <option value="es">Spanish</option>
                            </select>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-50 mb-2">Need Assistance?</h3>
                            <button id="call-crew-btn" class="w-full bg-blue-600 text-white font-semibold py-3 px-6 rounded-full hover:bg-blue-700 transition-colors duration-200">
                                Call Cabin Crew
                            </button>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById("dark-mode-toggle").addEventListener("change", (e) => {
                document.documentElement.classList.toggle("dark", e.target.checked);
                document.documentElement.classList.toggle("light", !e.target.checked);
            });
            document.getElementById("call-crew-btn").addEventListener("click", () => {
                assistanceModalTitle.textContent = "Assistance Requested";
                assistanceModalMessage.textContent = "A cabin crew member has been notified and will be with you shortly.";
                assistanceModal.classList.remove("hidden");
                assistanceModal.classList.add("flex");
            });
        }

        // Initial render
        document.addEventListener("DOMContentLoaded", () => {
            welcomePopup.classList.remove("hidden");
            welcomePopup.classList.add("flex");
        });
        changeView("home");
    </script>
</body>

</html>